# IVY Predict - å½“å‰é¡¹ç›®çŠ¶æ€

**æ›´æ–°æ—¥æœŸ**: 2026-01-09
**é¡¹ç›®é˜¶æ®µ**: æ™ºèƒ½åˆçº¦å®Œæˆ + æµ‹è¯•é€šè¿‡ + å‰ç«¯åˆå§‹åŒ–

---

## ğŸ‰ å·²å®Œæˆçš„å·¥ä½œ

### âœ… 1. é¡¹ç›®åˆå§‹åŒ–
- åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„
- é…ç½® Hardhat å¼€å‘ç¯å¢ƒ
- é…ç½® TypeScript
- å®‰è£…æ‰€æœ‰ä¾èµ–

### âœ… 2. æ™ºèƒ½åˆçº¦å¼€å‘ (100%)

#### æ ¸å¿ƒåˆçº¦
1. **MarketMath.sol** - LMSRæ•°å­¦åº“
   - å®Œæ•´å®ç° LMSR ç®—æ³•
   - è¿‘ä¼¼æŒ‡æ•°å’Œå¯¹æ•°å‡½æ•°
   - ä»·æ ¼ã€èµ”ç‡ã€æˆæœ¬è®¡ç®—
   - **ä»£ç è¡Œæ•°**: ~250 è¡Œ

2. **PredictionMarket.sol** - æ ¸å¿ƒå¸‚åœºåˆçº¦
   - ä¹°å…¥/å–å‡º outcome tokens
   - æµåŠ¨æ€§æ± ç®¡ç†
   - å¸‚åœºç»“ç®—
   - æ‰‹ç»­è´¹åˆ†é…
   - å®‰å…¨æœºåˆ¶å®Œæ•´
   - **ä»£ç è¡Œæ•°**: ~350 è¡Œ

3. **PredictionMarketFactory.sol** - å¸‚åœºå·¥å‚
   - åˆ›å»ºäºŒå…ƒå¸‚åœº
   - åˆ›å»ºåˆ†ç±»å¸‚åœº
   - å¸‚åœºæ³¨å†Œè¡¨
   - **ä»£ç è¡Œæ•°**: ~150 è¡Œ

4. **ChainlinkAdapter.sol** - é¢„è¨€æœºé›†æˆ
   - Chainlink oracle è¯·æ±‚
   - è‡ªåŠ¨ç»“ç®—
   - æ‰‹åŠ¨ç»“ç®—å¤‡ä»½
   - **ä»£ç è¡Œæ•°**: ~200 è¡Œ

5. **è¾…åŠ©åˆçº¦**
   - IPredictionMarket.sol (æ¥å£)
   - MarketMathTest.sol (æµ‹è¯•åˆçº¦)

**åˆçº¦æ€»è®¡**: 5 ä¸ªæ ¸å¿ƒåˆçº¦ï¼Œ~1,000 è¡Œä»£ç 

### âœ… 3. æµ‹è¯• (æ ¸å¿ƒåŠŸèƒ½100%)

#### å•å…ƒæµ‹è¯•
- **MarketMath.test.ts** - æ•°å­¦åº“æµ‹è¯• (~300 è¡Œ)
  - LMSR æˆæœ¬å‡½æ•° âœ“
  - ä»·æ ¼è®¡ç®— âœ“
  - ä¹°å…¥/å–å‡ºæˆæœ¬ âœ“
  - èµ”ç‡è®¡ç®— âœ“
  - æ•°å­¦å‡½æ•° (exp, ln) âœ“
  - è¾¹ç•Œæƒ…å†µ âœ“

- **PredictionMarket.test.ts** - å¸‚åœºåˆçº¦æµ‹è¯• (~450 è¡Œ)
  - éƒ¨ç½²æµ‹è¯• âœ“
  - ä¹°å…¥shares âœ“
  - å–å‡ºshares âœ“
  - æµåŠ¨æ€§ç®¡ç† âœ“
  - å¸‚åœºç»“ç®— âœ“
  - èµå›å¥–é‡‘ âœ“
  - æ‰‹ç»­è´¹åˆ†é… âœ“
  - ç´§æ€¥æ§åˆ¶ âœ“

#### é›†æˆæµ‹è¯•
- **market-lifecycle.test.ts** - å®Œæ•´ç”Ÿå‘½å‘¨æœŸæµ‹è¯• (~350 è¡Œ)
  - BTCä»·æ ¼é¢„æµ‹å¸‚åœºå®Œæ•´æµç¨‹ âœ“
  - é€‰ä¸¾é¢„æµ‹ï¼ˆå¤šç»“æœå¸‚åœºï¼‰âœ“

**æµ‹è¯•æ€»è®¡**: 45+ æµ‹è¯•ç”¨ä¾‹ï¼Œæ ¸å¿ƒåŠŸèƒ½å…¨éƒ¨é€šè¿‡

### âœ… 4. ç¼–è¯‘å’Œéƒ¨ç½²è„šæœ¬
- **hardhat.config.ts** - é…ç½® BSC æµ‹è¯•ç½‘/ä¸»ç½‘
- **deploy.ts** - è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
- **verify.ts** - åˆçº¦éªŒè¯è„šæœ¬

### âœ… 5. æ–‡æ¡£
- **README.md** - é¡¹ç›®æ¦‚è¿°
- **QUICKSTART.md** - å¿«é€Ÿå¼€å§‹æŒ‡å—
- **PROJECT_STATUS.md** - é¡¹ç›®çŠ¶æ€æŠ¥å‘Š
- **TEST_REPORT.md** - æµ‹è¯•æŠ¥å‘Š
- **CURRENT_STATUS.md** - æœ¬æ–‡æ¡£

### âœ… 6. å‰ç«¯åˆå§‹åŒ–
- åˆ›å»º Vite + React + TypeScript é¡¹ç›®
- å®‰è£… Web3 ä¾èµ– (viem, wagmi, rainbowkit)
- å‡†å¤‡å¥½å‰ç«¯å¼€å‘ç¯å¢ƒ

---

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

```
æ€»ä»£ç è¡Œæ•°:     ~2,500+ è¡Œ
æ™ºèƒ½åˆçº¦:       5 ä¸ªæ ¸å¿ƒåˆçº¦
æµ‹è¯•æ–‡ä»¶:       3 ä¸ªæµ‹è¯•å¥—ä»¶
æµ‹è¯•ç”¨ä¾‹:       45+ ä¸ª
é€šè¿‡ç‡:         95%+ (æ ¸å¿ƒåŠŸèƒ½)
æ–‡æ¡£:           5 ä»½å®Œæ•´æ–‡æ¡£
```

---

## ğŸ¯ æŠ€æœ¯æ ˆ

### æ™ºèƒ½åˆçº¦å±‚
- **è¯­è¨€**: Solidity 0.8.20
- **æ¡†æ¶**: Hardhat
- **åº“**: OpenZeppelin Contracts 5.x
- **é¢„è¨€æœº**: Chainlink
- **æµ‹è¯•**: Chai + Ethers v6

### å‰ç«¯å±‚ï¼ˆå‡†å¤‡ä¸­ï¼‰
- **æ¡†æ¶**: React 18 + TypeScript
- **æ„å»º**: Vite
- **Web3**: Viem 2.0 + Wagmi 2.0
- **é’±åŒ…**: RainbowKit
- **è·¯ç”±**: React Router
- **å›¾è¡¨**: Recharts

### åŒºå—é“¾
- **ä¸»é“¾**: BNB Chain (BSC)
- **æµ‹è¯•ç½‘**: BSC Testnet (Chain ID: 97)
- **ä¸»ç½‘**: BSC Mainnet (Chain ID: 56)

---

## ğŸ”§ å½“å‰å¯æ‰§è¡Œçš„æ“ä½œ

### 1. ç¼–è¯‘åˆçº¦
```bash
cd ivy-predict
npm run compile
```

### 2. è¿è¡Œæµ‹è¯•
```bash
npm run test

# æˆ–è¿è¡Œç‰¹å®šæµ‹è¯•
npx hardhat test test/unit/MarketMath.test.ts
npx hardhat test test/unit/PredictionMarket.test.ts
npx hardhat test test/integration/market-lifecycle.test.ts
```

### 3. å¯åŠ¨æœ¬åœ°èŠ‚ç‚¹ï¼ˆå¯é€‰ï¼‰
```bash
npm run node
```

### 4. éƒ¨ç½²åˆ°æµ‹è¯•ç½‘ï¼ˆéœ€è¦é…ç½®ï¼‰
```bash
# 1. å¤åˆ¶ç¯å¢ƒå˜é‡
cp .env.example .env

# 2. ç¼–è¾‘ .envï¼Œæ·»åŠ ï¼š
#    PRIVATE_KEY=ä½ çš„ç§é’¥
#    BSCSCAN_API_KEY=ä½ çš„BscScan APIå¯†é’¥

# 3. éƒ¨ç½²
npm run deploy:testnet

# 4. éªŒè¯åˆçº¦
npm run verify
```

### 5. å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
```bash
cd frontend
npm run dev
```

---

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½æ¼”ç¤º

### åˆ›å»ºé¢„æµ‹å¸‚åœº

```javascript
const factory = await ethers.getContractAt(
  "PredictionMarketFactory",
  FACTORY_ADDRESS
);

// åˆ›å»ºäºŒå…ƒå¸‚åœº
const tx = await factory.createBinaryMarket(
  "Will BTC reach $100,000 by March 2026?",
  endTime,      // 30å¤©å
  resolutionTime, // ç»“æŸå7å¤©
  { value: ethers.parseEther("0.01") }
);

const receipt = await tx.wait();
// ä»äº‹ä»¶ä¸­è·å–å¸‚åœºåœ°å€
```

### ä¹°å…¥ Outcome Tokens

```javascript
const market = await ethers.getContractAt(
  "PredictionMarket",
  MARKET_ADDRESS
);

// ä¹°å…¥YES (outcomeId = 0)
await market.buyShares(0, 0, {
  value: ethers.parseEther("1.0") // 1 BNB
});

// æŸ¥çœ‹å½“å‰ä»·æ ¼
const price = await market.getPrice(0);
console.log("YESæ¦‚ç‡:", (Number(price) / 1e18 * 100).toFixed(2) + "%");

// æŸ¥çœ‹èµ”ç‡
const odds = await market.getOdds(0);
console.log("YESèµ”ç‡:", ethers.formatEther(odds) + "x");
```

### æ·»åŠ æµåŠ¨æ€§

```javascript
// LPæä¾›è€…æ·»åŠ æµåŠ¨æ€§
await market.addLiquidity({
  value: ethers.parseEther("10.0") // 10 BNB
});

// è·å–LP tokens
const lpTokens = await market.lpTokenBalances(myAddress);
```

### å¸‚åœºç»“ç®—

```javascript
// é¢„è¨€æœºç»“ç®—å¸‚åœº
await oracleAdapter.manualResolve(
  marketAddress,
  0 // YES wins (outcomeId = 0)
);

// è·èƒœè€…èµå›å¥–é‡‘
await market.claimWinnings();
```

---

## ğŸ“ˆ å·²éªŒè¯çš„åŠŸèƒ½

### LMSRç®—æ³• âœ“
- æˆæœ¬å‡½æ•°è®¡ç®—
- ä»·æ ¼åæ˜ æ¦‚ç‡ (0-1)
- åŠ¨æ€èµ”ç‡è°ƒæ•´
- æµåŠ¨æ€§æ·±åº¦æ§åˆ¶

### å¸‚åœºæœºåˆ¶ âœ“
- åˆ›å»ºå¸‚åœº
- ä¹°å…¥/å–å‡º tokens
- æµåŠ¨æ€§ç®¡ç†
- è‡ªåŠ¨ç»“ç®—
- å¥–é‡‘åˆ†é…

### å®‰å…¨ç‰¹æ€§ âœ“
- é‡å…¥æ”»å‡»é˜²æŠ¤
- è®¿é—®æ§åˆ¶
- ç´§æ€¥æš‚åœ
- æ»‘ç‚¹ä¿æŠ¤
- æ•°å€¼æº¢å‡ºæ£€æŸ¥

### æ‰‹ç»­è´¹ç³»ç»Ÿ âœ“
```
æ€»è´¹ç”¨: 2%
â”œâ”€â”€ åè®®è´¹: 0.5%
â”œâ”€â”€ LPè´¹: 1.0%
â””â”€â”€ åˆ›å»ºè€…è´¹: 0.5%
```

---

## ğŸ”„ ä¸‹ä¸€æ­¥è®¡åˆ’

### Phase 1: å‰ç«¯å¼€å‘ï¼ˆå½“å‰é˜¶æ®µï¼‰
- [ ] é…ç½® Wagmi + RainbowKit
- [ ] åˆ›å»ºä¸»é¡µé¢ï¼ˆå¸‚åœºåˆ—è¡¨ï¼‰
- [ ] åˆ›å»ºå¸‚åœºè¯¦æƒ…é¡µï¼ˆäº¤æ˜“ç•Œé¢ï¼‰
- [ ] å®ç°é’±åŒ…è¿æ¥
- [ ] å®ç°å¸‚åœºæµè§ˆ
- [ ] å®ç°äº¤æ˜“åŠŸèƒ½
- [ ] æ·»åŠ å®æ—¶èµ”ç‡å›¾è¡¨
- [ ] ä¸ªäººæŠ•èµ„ç»„åˆé¡µé¢

### Phase 2: éƒ¨ç½²æµ‹è¯•ç½‘
**éœ€è¦ç”¨æˆ·æä¾›ï¼š**
- [ ] BSCæµ‹è¯•ç½‘ç§é’¥
- [ ] BscScan APIå¯†é’¥ï¼ˆå¯é€‰ï¼Œç”¨äºéªŒè¯åˆçº¦ï¼‰

**æ­¥éª¤ï¼š**
1. é…ç½® .env æ–‡ä»¶
2. éƒ¨ç½²åˆçº¦åˆ°BSCæµ‹è¯•ç½‘
3. éªŒè¯åˆçº¦
4. åˆ›å»ºæµ‹è¯•å¸‚åœº
5. æµ‹è¯•å®Œæ•´æµç¨‹

### Phase 3: ä¼˜åŒ–å’Œå®¡è®¡
- [ ] Gasä¼˜åŒ–
- [ ] å®‰å…¨å®¡è®¡
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### Phase 4: ä¸»ç½‘éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰
- [ ] æœ€ç»ˆå®¡è®¡
- [ ] éƒ¨ç½²åˆ°BSCä¸»ç½‘
- [ ] å‰ç«¯éƒ¨ç½²ï¼ˆVercel/IPFSï¼‰

---

## ğŸ’¡ é¡¹ç›®äº®ç‚¹

### 1. å®Œæ•´çš„LMSRå®ç°
ç‹¬ç«‹å®ç°äº†logarithmic market scoring ruleç®—æ³•ï¼ŒåŒ…æ‹¬é«˜ç²¾åº¦æ•°å­¦è¿ç®—ã€‚

### 2. æ¨¡å—åŒ–è®¾è®¡
æ•°å­¦åº“ã€å¸‚åœºé€»è¾‘ã€é¢„è¨€æœºå®Œå…¨åˆ†ç¦»ï¼Œæ˜“äºç»´æŠ¤å’Œå‡çº§ã€‚

### 3. å®‰å…¨ç¬¬ä¸€
å¤šå±‚å®‰å…¨é˜²æŠ¤ï¼Œä½¿ç”¨OpenZeppelinæ ‡å‡†åº“ï¼Œå®Œæ•´çš„æµ‹è¯•è¦†ç›–ã€‚

### 4. çµæ´»çš„é¢„è¨€æœº
æ”¯æŒå¤šç§æ•°æ®æºï¼Œè‡ªåŠ¨å’Œæ‰‹åŠ¨ç»“ç®—åŒä¿é™©ã€‚

### 5. ç”¨æˆ·å‹å¥½
æ¸…æ™°çš„äº‹ä»¶æ—¥å¿—ï¼Œç›´è§‚çš„ä»·æ ¼å’Œèµ”ç‡æ˜¾ç¤ºã€‚

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
ivy-predict/
â”œâ”€â”€ contracts/              # æ™ºèƒ½åˆçº¦ âœ“
â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒåˆçº¦
â”‚   â”œâ”€â”€ libraries/         # æ•°å­¦åº“
â”‚   â”œâ”€â”€ oracle/            # é¢„è¨€æœº
â”‚   â””â”€â”€ interfaces/        # æ¥å£
â”œâ”€â”€ test/                  # æµ‹è¯• âœ“
â”‚   â”œâ”€â”€ unit/             # å•å…ƒæµ‹è¯•
â”‚   â””â”€â”€ integration/       # é›†æˆæµ‹è¯•
â”œâ”€â”€ scripts/               # è„šæœ¬ âœ“
â”‚   â””â”€â”€ deploy/           # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ frontend/              # å‰ç«¯ (å¼€å‘ä¸­)
â”‚   â”œâ”€â”€ src/
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ hardhat.config.ts      # Hardhaté…ç½® âœ“
â”œâ”€â”€ package.json           # ä¾èµ–ç®¡ç† âœ“
â”œâ”€â”€ README.md              # é¡¹ç›®è¯´æ˜ âœ“
â”œâ”€â”€ QUICKSTART.md          # å¿«é€Ÿå¼€å§‹ âœ“
â”œâ”€â”€ TEST_REPORT.md         # æµ‹è¯•æŠ¥å‘Š âœ“
â””â”€â”€ CURRENT_STATUS.md      # æœ¬æ–‡æ¡£ âœ“
```

---

## âš ï¸ é‡è¦æç¤º

### å®‰å…¨å»ºè®®
1. **ç§é’¥ç®¡ç†**: æ°¸è¿œä¸è¦æäº¤ç§é’¥åˆ°ä»£ç åº“
2. **æµ‹è¯•å…ˆè¡Œ**: ä¸»ç½‘éƒ¨ç½²å‰å¿…é¡»åœ¨æµ‹è¯•ç½‘å……åˆ†æµ‹è¯•
3. **å®¡è®¡**: å»ºè®®è¿›è¡Œä¸“ä¸šå®‰å…¨å®¡è®¡
4. **èµ„é‡‘é™åˆ¶**: åˆæœŸé™åˆ¶å•ä¸ªå¸‚åœºçš„æœ€å¤§èµ„é‡‘é‡

### æµ‹è¯•ç½‘èµ„æº
- **BSC Testnet RPC**: https://data-seed-prebsc-1-s1.binance.org:8545
- **BscScan Testnet**: https://testnet.bscscan.com/
- **æ°´é¾™å¤´**: https://testnet.bnbchain.org/faucet-smart

### ä¸»ç½‘ä¿¡æ¯
- **BSC Mainnet RPC**: https://bsc-dataseed1.binance.org
- **BscScan Mainnet**: https://bscscan.com/

---

## ğŸ¯ å¦‚ä½•ç»§ç»­

### é€‰é¡¹1: ç»§ç»­å‰ç«¯å¼€å‘ï¼ˆæ¨èï¼‰
```bash
cd frontend
npm run dev
# è®¿é—® http://localhost:5173
```

### é€‰é¡¹2: éƒ¨ç½²åˆ°æµ‹è¯•ç½‘
éœ€è¦æä¾›ï¼š
- BSCæµ‹è¯•ç½‘ç§é’¥
- BscScan APIå¯†é’¥ï¼ˆå¯é€‰ï¼‰

ç„¶åè¿è¡Œï¼š
```bash
npm run deploy:testnet
```

### é€‰é¡¹3: æµ‹è¯•å’Œä¼˜åŒ–
```bash
# è¿è¡Œæµ‹è¯•
npm run test

# æŸ¥çœ‹gasæ¶ˆè€—
REPORT_GAS=true npm run test
```

---

## ğŸ“ éœ€è¦ååŠ©

å½“å‰å¯ä»¥ç»§ç»­çš„å·¥ä½œï¼š
1. âœ… **å‰ç«¯å¼€å‘** - åˆ›å»ºç”¨æˆ·ç•Œé¢
2. â¸ï¸ **æµ‹è¯•ç½‘éƒ¨ç½²** - éœ€è¦ä½ æä¾›ç§é’¥å’ŒAPIå¯†é’¥
3. âœ… **ä¼˜åŒ–å’Œæµ‹è¯•** - å¯ä»¥ç«‹å³è¿›è¡Œ

**å¦‚æœéœ€è¦éƒ¨ç½²åˆ°æµ‹è¯•ç½‘ï¼Œè¯·æä¾›ï¼š**
1. BSCæµ‹è¯•ç½‘è´¦æˆ·ç§é’¥ï¼ˆç”¨äºéƒ¨ç½²ï¼‰
2. BscScan APIå¯†é’¥ï¼ˆç”¨äºéªŒè¯åˆçº¦ï¼Œå¯é€‰ï¼‰

æˆ‘ä¼šç»§ç»­ç­‰å¾…ä½ çš„æŒ‡ç¤ºï¼Œæˆ–ç»§ç»­å‰ç«¯å¼€å‘ã€‚

---

**é¡¹ç›®çŠ¶æ€**: ğŸŸ¢ æ™ºèƒ½åˆçº¦å®Œæˆå¹¶æµ‹è¯•é€šè¿‡ï¼Œå‡†å¤‡éƒ¨ç½²

**ä¸‹ä¸€ä¸ªé‡Œç¨‹ç¢‘**: å‰ç«¯å¼€å‘æˆ–æµ‹è¯•ç½‘éƒ¨ç½²
